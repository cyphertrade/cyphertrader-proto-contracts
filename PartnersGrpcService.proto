syntax = "proto3";
package partners_grpc;
import "google/protobuf/empty.proto";

// ========== Errors and Enums ==========
enum PartnerErrorType{
    UNSPECIFIED = 0;
    DATABASE_ERROR = 1;
    USER_NOT_FOUND = 2;
    USER_GROUP_NOT_FOUND = 3;
    PARTNER_PROFILE_NOT_FOUND = 4;
    GRPC_ERROR = 5;
    CAMPAIGN_NOT_FOUND = 6;
    VALIDATION_ERRORS = 7;
    EVAL_EXP_ERRORS = 8;
    CAMPAIGN_INVALID_COMMISSION_SETTINGS = 9;
    REACHED_MAX_AMOUNT_OF_ACTIVE_CAMPAIGNS = 10;
    REACHED_MAX_AMOUNT_CAMPAIGN_PARAMS = 11;
}

message PartnerError{
    PartnerErrorType ErrorType = 1;
    optional string Message = 2;
}

// ========== Campaign Models ==========
message CampaignGrpcModel {
    string Id = 1;
    string PartnerId = 2;
    string Name = 3;
    map<string, string> DefaultUtms = 4;
}

// ========== Get Campaign ==========
message GetPartnerCampaignGrpcRequest {
    optional string CampaignId = 1;
    string PartnerId = 2;
    optional string Name = 3;
    map<string, string> UtmFilters = 4; // Filter by each UTM key-value pair
}

message GetPartnerCampaignsList {
    repeated CampaignGrpcModel Campaigns = 1;
}

message GetPartnerCampaignGrpcResponse {
    oneof GetPartnerCampaignResult {
        GetPartnerCampaignsList Campaigns = 1;
        PartnerError Error = 2;
    }
}

// ========== Create Campaign ==========
message CreatePartnerCampaignGrpcRequest {
    string PartnerId = 1;
    string Name = 2;
    map<string, string> DefaultUtms = 3;
}

message CreatePartnerCampaignGrpcResponse {
    oneof CreatePartnerCampaignResult {
        CampaignGrpcModel Campaign = 1;
        PartnerError Error = 2;
    }
}

// ========== Update Campaign ==========
message UpdatePartnerCampaignGrpcRequest {
    string CampaignId = 1;
    string PartnerId = 2;
    optional string Name = 3;
    map<string, string> DefaultUtms = 4;
}

message UpdatePartnerCampaignGrpcResponse {
    oneof UpdatePartnerCampaignResult {
        CampaignGrpcModel Campaign = 1;
        PartnerError Error = 2;
    }
}

// ========== Delete Campaign ==========
message DeletePartnerCampaignGrpcRequest {
    string CampaignId = 1;
    string PartnerId = 2;
}

message DeletePartnerCampaignGrpcResponse {
    oneof DeletePartnerCampaignResult {
        google.protobuf.Empty Success = 1;
        PartnerError Error = 2;
    }
}

// ========== Service ==========
service PartnersGrpcService {
    rpc GetPartnerCampaign(GetPartnerCampaignGrpcRequest) returns (GetPartnerCampaignGrpcResponse);
    rpc CreatePartnerCampaign(CreatePartnerCampaignGrpcRequest) returns (CreatePartnerCampaignGrpcResponse);
    rpc UpdatePartnerCampaign(UpdatePartnerCampaignGrpcRequest) returns (UpdatePartnerCampaignGrpcResponse);
    rpc DeletePartnerCampaign(DeletePartnerCampaignGrpcRequest) returns (DeletePartnerCampaignGrpcResponse);
    rpc Ping(google.protobuf.Empty) returns (google.protobuf.Empty);
}
