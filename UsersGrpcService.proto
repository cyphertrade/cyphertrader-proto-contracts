syntax = "proto3";
package users_grpc;
import "google/protobuf/empty.proto";

// Error types enumeration
enum UsersGrpcErrorType {
    UNSPECIFIED = 0;
    HASH_ERROR = 1;
    BASE64_ERROR = 2;
    INVALID_AUTH_CREDENTIALS = 3;
    USER_NOT_FOUND = 4;
    DB_ERROR = 5;
    INVALID_SETTINGS = 6;
    VALIDATION_ERROR = 7;
    USER_GROUP_NOT_FOUND = 8;
}

// Error response model
message UsersGrpcError {
    UsersGrpcErrorType error_type = 1;
    optional string message = 2;  
}

message UserGrpcModel{
    string Id = 1;
    string UserGroup = 2;
}

message UserDataGrpcModel{
    UserGrpcModel User = 1;
    map<string, string> Sources = 2;
}

message RegisterUserGrpcRequest {
    string Email = 1;
    string Password = 2;
}

message RegisterUserGrpcResponse{
    oneof register_user_result{
        UserGrpcModel User = 1;
        UsersGrpcError Error = 2;
    }
}

message UpdateUserGrpcRequest{
    string Id = 1;
    string UserGroup = 2;
}

message UpdateUserGrpcResponse{
    oneof update_user_result{
        UserGrpcModel User = 1;
        UsersGrpcError Error = 2;
    }
}

message UpdateUserSourcesGrpcRequest{
    string UserId = 1;
    map<string, string> Sources = 2;
}

message UpdateUserSourcesGrpcResponse{
    oneof update_user_sources_result{
        UserDataGrpcModel UserData = 1;
        UsersGrpcError Error = 2;
    }
}

message VerifyUserCredentialsGrpcRequest{
    string Email = 1;
    string Password = 2;
}

message VerifyUserCredentialsGrpcResponse{
    oneof verify_user_credentials_result{
        UserGrpcModel User = 1;
        UsersGrpcError Error = 2;
    }
}

message GetUserGrpcRequest{
    string UserId = 1;
}

message GetUserGrpcResponse{
    optional UserDataGrpcModel UserData = 1;
}

service UsersGrpcService {
    rpc RegisterUser (RegisterUserGrpcRequest) returns (RegisterUserGrpcResponse);
    rpc UpdateUser (UpdateUserGrpcRequest) returns (UpdateUserGrpcResponse);
    rpc UpdateUserSources (UpdateUserSourcesGrpcRequest) returns (UpdateUserSourcesGrpcResponse);
    rpc VerifyUserCredentials (VerifyUserCredentialsGrpcRequest) returns (VerifyUserCredentialsGrpcResponse);
    rpc GetUser (GetUserGrpcRequest) returns (GetUserGrpcResponse);
    rpc Ping(google.protobuf.Empty) returns (google.protobuf.Empty);
}
